<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Drag MVP</title>
<script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
<style>
html,body{margin:0;background:#111}
</style>
</head>
<body>
<script>
/* ===== parameters ===== */
const GRID = 5;
const CELL = 80;
const DRAG_THRESHOLD = 20;

/* ===== state ===== */
let cube = { x: 2, y: 2 };
let dragDX = 0, dragDY = 0;
let dragging = false;

/* ===== helpers ===== */
function inside(x,y){
  return x>=0 && x<GRID && y>=0 && y<GRID;
}

/* ===== p5 ===== */
new p5(p=>{
  p.setup = ()=>{
    p.createCanvas(GRID*CELL, GRID*CELL);
  };

  p.draw = ()=>{
    p.background(20);

    // grid
    p.stroke(120);
    for(let i=0;i<=GRID;i++){
      p.line(i*CELL,0,i*CELL,p.height);
      p.line(0,i*CELL,p.width,i*CELL);
    }

    // cube
    p.noStroke();
    p.fill(200);
    p.rect(
      cube.x*CELL+5,
      cube.y*CELL+5,
      CELL-10,
      CELL-10
    );

    // drag line (debug)
    if(dragging){
      p.stroke(255);
      p.line(
        p.mouseX-dragDX,
        p.mouseY-dragDY,
        p.mouseX,
        p.mouseY
      );
    }
  };

  p.mousePressed = ()=>{
    dragging = true;
    dragDX = dragDY = 0;
  };

  p.mouseDragged = ()=>{
    if(!dragging) return;
    dragDX += p.movedX;
    dragDY += p.movedY;
  };

  p.mouseReleased = ()=>{
    if(!dragging) return;
    dragging = false;

    if(Math.hypot(dragDX, dragDY) < DRAG_THRESHOLD) return;

    let dir =
      Math.abs(dragDX) > Math.abs(dragDY)
        ? (dragDX > 0 ? "east" : "west")
        : (dragDY > 0 ? "south" : "north");

    const nx = cube.x + (dir==="east") - (dir==="west");
    const ny = cube.y + (dir==="south") - (dir==="north");

    if(inside(nx,ny)){
      cube.x = nx;
      cube.y = ny;
    }
  };
});
</script>
</body>
</html>